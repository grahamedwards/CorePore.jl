var documenterSearchIndex = {"docs":
[{"location":"","page":"Home","title":"Home","text":"CurrentModule = CorePore","category":"page"},{"location":"#CorePore","page":"Home","title":"CorePore","text":"","category":"section"},{"location":"","page":"Home","title":"Home","text":"Documentation for CorePore.","category":"page"},{"location":"","page":"Home","title":"Home","text":"","category":"page"},{"location":"","page":"Home","title":"Home","text":"Modules = [CorePore]","category":"page"},{"location":"#CorePore.ClimateHistory","page":"Home","title":"CorePore.ClimateHistory","text":"ClimateHistory\n\nCustom struct to contain a climate record x over timescale t, where t contains n timesteps.\n\nThe type generated by LR04, which is used for (perhaps unnecessary) type stability and code readability.\n\n\n\n\n\n","category":"type"},{"location":"#CorePore.Constants","page":"Home","title":"CorePore.Constants","text":"Constants( ; k, dt, dz, depth )\n\nReturns a Constants struct containing constants and coefficients used in diffusion history calculations. The inputs and their default values are listed in the table below. From these it calculates a few convenient variables–-the product dt * dz (dtdz), a Range of node depths z (in m), the number of nodes nz, and the penultimate_node–-as well as temperature-dependent diffusion coefficients used in diffusionadvection, using the temperature-depth paramterization of Morin+ 2010. These are returned as Vectors of length nz, where each cell corresponds to a depth node in z. The two coefficients are k1 and k2, both of which are follwed with cl or w to denote Cl⁻ or water, respectively: k1cl, k2cl, k1w, and k2w.\n\nfield description default\nk hydraulic conductivity of sediment column 0.1 m / yr\ndt timestep 10 yrs\ndz node spacing 5 m\ndepth sediment column depth 2000 m\n\n\n\n\n\n","category":"type"},{"location":"#CorePore.CoreData","page":"Home","title":"CorePore.CoreData","text":"CoreData(z, mCl, σCl, mO, σO)\n\nReturns an  CoreData struct with sediment core data formatted for porewatermetropolis — (; z, Cl = (mu, sig), O = (mu, sig)). Inputs are Vectors for values of sample depths z (meters below sea floor), measured (mean) chlorinity mCl and 1σ uncertainty σCl, and measured (mean) δ¹⁸O mO and 1σ uncertainties σO. \n\nVectors must all be of the same length. If Cl and δ¹⁸O sampling is not 1:1, use NaN or anything that is not a subtype of Number (e.g. missing, nothing). While NaN is used internally, CoreData does this conversion for you.\n\n\n\nCoreData(z, m, σ, measurement)\n\nSame as above, but for a core with only chlorinity or δ¹⁸O data (the other Vectors are empty to return null values in loglikelihood calculations). Provide sample depths z, measured means m, 1σ uncertainties σ, and the measurement as a symbol, e.g. :Cl or :O. \n\n\n\nCorePore.jl comes loaded with convenience functions to generate data for andrill2a from Tracy+ 2010 (doi:10.1130/G30849.1) and andrill1b from Pompilio+ 2007 (https://digitalcommons.unl.edu/andrillrespub/37). \n\n\n\n\n\n","category":"type"},{"location":"#CorePore.PorewaterProperty","page":"Home","title":"CorePore.PorewaterProperty","text":"PorewaterProperty(n::Int, [, x])\n\nstruct to contain sediment column poperties at each node for a prior timestep o and present timestep p.\n\nConstructor function returns an instance of PorewaterProperty with vectors of length n.  Optionally provide a value x <: Number to fill vectors with (otherwise values are undefined). \n\n\n\n\n\n","category":"type"},{"location":"#CorePore.Proposal","page":"Home","title":"CorePore.Proposal","text":"Proposal\n\nStruct containing porewater parameters (described below). All inputs must be of type Number (converts to Float64). Built-in functionality includes splatting (...) and CorePore.fastsplat.\n\nfield description units default\nonset onset of model ka 5320\ndfrz freezing rate m/yr 0.0001\ndmlt melting rate m/yr 0.001\nsea2frz Benthic δ¹⁸O threshold for subglacial freezing ‰ 3.5\nfrz2mlt Benthic δ¹⁸O threshold for subglacial melting ‰ 4.2\nflr depth of diffusion-dominated porewater column m 1000.\nbasalCl chloridity at base of diffusion-dominated column g/kg 119.4\nbasalO δ¹⁸O at base of diffusion-dominated column g/kg -25.2\n\nsee also: update\n\n\n\n\n\n","category":"type"},{"location":"#CorePore.SedimentColumn","page":"Home","title":"CorePore.SedimentColumn","text":"SedimentColumn(n::Int, [, Cl, O])\n\nstruct to contain PorewaterPropertys for the porewater properties of chloridity (Cl), δ¹⁸O (O), and density (rho).\n\nConstructor function returns an instance of SedimentColumn with PorewaterProperty vectors of length n.  Optionally provide values for Cl, O, and rho (otherwise values are undefined). \n\nsee also: PorewaterProperty, density\n\n\n\n\n\n","category":"type"},{"location":"#CorePore.Water","page":"Home","title":"CorePore.Water","text":"water(Cl, O)\n\nCustom struct containing Float64 values of chlorinity Cl and δ¹⁸O O. Built-in splatting functionality.\n\nsee also: mcmurdoshelf, mcmurdosound\n\n\n\n\n\n","category":"type"},{"location":"#CorePore.LR04-Tuple{}","page":"Home","title":"CorePore.LR04","text":"LR04()\n\nGenerate a ClimateHistory instance containing the Liesiecki & Raymo 2004 benthic stack (data, publication) interpolated for 1 ka timesteps and going forward in time from 5.32 Ma. \n\nfield description\nt time (ka)\nx benthic δ¹⁸O (‰)\nn timesteps in t\n\n\n\n\n\n","category":"method"},{"location":"#CorePore.andrill1b-Tuple{}","page":"Home","title":"CorePore.andrill1b","text":"andrill1b\n\nGenerate a CoreData instance with data from core ANDRILL-1B (from Pompilio+ 2007 (https://digitalcommons.unl.edu/andrillrespub/37)). \n\nsee also: CoreData\n\n\n\n\n\n","category":"method"},{"location":"#CorePore.andrill2a-Tuple{}","page":"Home","title":"CorePore.andrill2a","text":"andrill2a\n\nGenerate a CoreData instance with data from core ANDRILL-2A (from Frank+ 2010, doi:10.1130/G30849.1). \n\nsee also: CoreData\n\n\n\n\n\n","category":"method"},{"location":"#CorePore.boundaryconditions-Tuple{Float64, Float64, Vararg{Any, 9}}","page":"Home","title":"CorePore.boundaryconditions","text":"function boundaryconditions(Cl, d18O, x, sea2freeze,freeze2melt, meltrate, freezerate, Clsw, d18Osw, dz, dt)\n\nCalculates sediment surface boundary condition for δ¹⁸O (d18O) and chloridity (Cl), based on the thermodynamic state described by the current current benthic δ¹⁸O value x and the threshold values corresponding to subglacial freezing sea2freeze and subglacial melting freeze2melt.\n\nFor melting or freezing states, calculates boundary condition from the assumed meltrate, freezerate, timestep dt, length-step dt, and composition of seawater Clsw and d18Osw.\n\n\n\n\n\n","category":"method"},{"location":"#CorePore.chlordiffuseadvectcolumn!-Tuple{SedimentColumn, Constants, Float64}","page":"Home","title":"CorePore.chlordiffuseadvectcolumn!","text":"chlordiffuseadvectcolumn!(sc, k, flr)\n\nSame as diffuseadvectcolumn!, but skipping δ¹⁸O calculations. \n\n\n\n\n\n","category":"method"},{"location":"#CorePore.chlorporewaterhistory!-Tuple{SedimentColumn, Proposal, Constants, CorePore.ClimateHistory, Water, Int64}","page":"Home","title":"CorePore.chlorporewaterhistory!","text":"chlorporewaterhistory!(sc, p, k, climhist, seawater, ka_dt)\n\nSame as porewaterhistory, but skipping δ¹⁸O calculations. \n\n\n\n\n\n","category":"method"},{"location":"#CorePore.deepbonney-Tuple{}","page":"Home","title":"CorePore.deepbonney","text":"deepbonney()\n\nGenerate a [`Water`](@ref) instance with >30 m Lake Bonney water compositions. Use for sediment column basal boundary condition. Chloridity (143.333 g/L  ÷ 1.2 kg/L ≈ 119 g/kg) from Angino+ 1963 ([doi:10.1086/626879](https://doi.org/10.1086/626879)) and δ¹⁸O from Matsubaya+ 1979 ([doi:10.1016/0016-7037(79)90042-5](https://doi.org/10.1016/0016-7037(79)90042-5)).\n\n\n\n\n\n","category":"method"},{"location":"#CorePore.density-Tuple{Any}","page":"Home","title":"CorePore.density","text":"density(chlorinity)\n\nCalculates the density of a water parcel with chlorinity in units g/m³ (rather than kg/m³ for convenience with velocity)\n\nsee also: velocity\n\n\n\n\n\n","category":"method"},{"location":"#CorePore.diffuseadvectcolumn!-Tuple{SedimentColumn, Constants, Float64}","page":"Home","title":"CorePore.diffuseadvectcolumn!","text":"diffuseadvectcolumn!(sc, k, flr)\n\nCalculate diffusive and advective transport of chlorinity and isotope-traced water through a sediment column described by properties in k, a NamedTuple generated by the Constants function.\n\nOverwrites the o and p PorewaterProperty fields of sc – a SedimentColumn with pre-existing conditions of Cl, O, and rho in its o fields.\n\nrelies on: velocity, density, diffusionadvection, \n\nsee also: SedimentColumn, Constants \n\n\n\n\n\n","category":"method"},{"location":"#CorePore.diffusion-NTuple{4, Any}","page":"Home","title":"CorePore.diffusion","text":"diffusion(x,above,below,k)\n\nCalculate the property of a node in a vertical profile given the effect of diffusion, alone. Returns the property given initial values for the node x, the overlying node above, the underlying node below, and (dt/dz²-scaled) diffusion coefficient k.\n\n\n\n\n\n","category":"method"},{"location":"#CorePore.diffusionadvection-NTuple{8, Any}","page":"Home","title":"CorePore.diffusionadvection","text":"diffusionadvection(x,above,below,k1,k2,v,dt,dz)\n\nCalculate the property of a node in a vertical profile given the combined effects of diffusion and advection. Returns the property given initial values for the node x, the overlying node above, the underlying node below, (dt/dz-scaled) diffusion coefficients k1 and k2, vertical advection velocity v, timestep dt, and lengthstep dz. Alternatively provide the product of v * dt * dz for a minor speed-up.\n\n\n\n\n\n","category":"method"},{"location":"#CorePore.dt_climatetimestep-Tuple{AbstractRange, Number}","page":"Home","title":"CorePore.dt_climatetimestep","text":"dt_climatetimestep(katime,dt)\n\nA helper function to calculate the number of diffusion model timesteps dt (in years) in each timestep of the climate timescale katime (in kiloannum). Returns an integer. \n\n\n\n\n\n","category":"method"},{"location":"#CorePore.equilibratecolumn!-Tuple{SedimentColumn, Water, Water, StepRangeLen, Float64}","page":"Home","title":"CorePore.equilibratecolumn!","text":"equilibratecolumn!(sc, seawater, basalwater, z, flr)\n\nCalculate an equilibrium linear profile for all SedimentColumn vectors in sc between a seafloor seawater and basalwater composition, given node depths z and diffusion-dominated column depth flr.\n\n\n\n\n\n","category":"method"},{"location":"#CorePore.fastsplat-Tuple{Proposal}","page":"Home","title":"CorePore.fastsplat","text":"fastsplat(x::Proposal)\n\nReturns a tuple of the contents of x. Avoids type inherent instability of Base.iterate for fast splatting.\n\n\n\n\n\n","category":"method"},{"location":"#CorePore.linterp-NTuple{5, Any}","page":"Home","title":"CorePore.linterp","text":"linterp(x, x₁, Δx, y₂, y₁ )\n\nEstimate the value of y corresponding to x given known coordinate (x₁, y₁), value y₂, and Δx= x₂ - x₁. Note that if x==x₁, y= y₁. \n\n\n\n\n\n","category":"method"},{"location":"#CorePore.loglikelihood-Union{Tuple{T}, Tuple{T, T, T, AbstractRange{Float64}, T}} where T<:Vector{Float64}","page":"Home","title":"CorePore.loglikelihood","text":"loglikelihood( zₒ, μ, σ, zₘ, m )\n\nCalculate the (relative) log-likelihood that model values in m simulated at depth nodes in zₘ were drawn from normally distributed observations with sample depths, mean values, and 1σ uncertainties in corresponding indices of the Vectors zₒ, μₒ, and σ. The simulated value is linearly interpolated between bounding depth nodes in zₘ.\n\nsee also: normll, linterp\n\n\n\n\n\n","category":"method"},{"location":"#CorePore.mcmurdoshelf-Tuple{}","page":"Home","title":"CorePore.mcmurdoshelf","text":"mcmurdoshelf()\n\nGenerate a Water instance with coretop porewater compositions from the McMurdo ice shelf. Pairs with core ANDRILL-1B.\n\nsee also: andrill1b\n\n\n\n\n\n","category":"method"},{"location":"#CorePore.mcmurdosound-Tuple{}","page":"Home","title":"CorePore.mcmurdosound","text":"mcmurdosound()\n\nGenerate a Water instance with southern McMurdo Sound water compositions. Pair with core ANDRILL-2A.\n\nsee also:  andrill2a\n\n\n\n\n\n","category":"method"},{"location":"#CorePore.normll-Tuple{Float64, Float64, Float64}","page":"Home","title":"CorePore.normll","text":"normll(x, μ, σ)\n\nCalculate the (relative) log-likelihood that an observation x was drawn from the normal distribution with mean μ and standard deviation σ. If μ is a NaN (instead of missing for type homogeneity), returns 0.\n\nNote: This function excludes a constant that will not vary for different vlaues of x to speed up calculation in metropolis. To calculate the absolute log-likelihood, take the log of normpdf\n\n\n\n\n\n","category":"method"},{"location":"#CorePore.normpdf-Tuple{Number, Number, Number}","page":"Home","title":"CorePore.normpdf","text":"normpdf(x, μ, σ)\n\nCalculate the probability density of a normal distribution with mean μ and standard deviation σ at the value x.\n\n\n\n\n\n","category":"method"},{"location":"#CorePore.porewaterhistory!-Tuple{SedimentColumn, Proposal, Constants, CorePore.ClimateHistory, Water, Int64}","page":"Home","title":"CorePore.porewaterhistory!","text":"porewaterhistory!(sc::SedimentColumn, p::Proposal, k::Constants, climhist::NamedTuple, seawater::Water, ka_dt::Int)\n\nIn-place version of porewaterhistory, which takes every input as an arg (rather than some defaults as kwargs). It also requires you to provide ka_dt – the number of diffusion timesteps in each thousand-year climate timestep.\n\nsee also: porewaterhistory\n\n\n\n\n\n","category":"method"},{"location":"#CorePore.porewaterhistory-Tuple{Proposal}","page":"Home","title":"CorePore.porewaterhistory","text":"porewaterhistory(p [; k=Constants(), climatehistory=LR04(), seawater=mcmurdosound()])\n\nCalculate the porewater advection-diffusion history of chlorinity and O-isotope-traced water in a sediment column described by properties in k (::Constants) over a given ClimateHistory (LR04 by default) and coretop seawater compositions.\n\nProposal) instance p describes the sensitivity and response of the system to climate fluctuations as recorded in climatehistory.\n\nSee diffuseadvectcolumn! for the underlying diffusion-advection transport calculations.\n\nsee also: porewaterhistory!, Proposal, Constants, LR04, Water\n\n\n\n\n\n","category":"method"},{"location":"#CorePore.porewatermetropolis-Tuple{Proposal, Proposal, CoreData}","page":"Home","title":"CorePore.porewatermetropolis","text":"porewatermetropolis(p, σ, prior; burnin=10, chainsteps=10, climate, k, seawater, onlychloride=true, explore, rng)\n\nExecutes a Markov chain Monte Carlo (MCMC) routine that explores the parameter space of the variables in Proposal instance p, constrained by sediment column porewater chemistry records in CoreData instance prior and climate record in ClimateHistory instance climate (=LR04 by default). Proposal instance σ describes the (1σ) Gaussian jump size corresponding to each field in p (note that fields :dmlt, :dfrz, and :basalCl use a log-normal jump and require a log-space value in σ). \n\nKwarg onlychloride determines whether the MCMC inverts for only porewater chloridity (default=true) or porewater chloridity and δ¹⁸O (false).\n\nAdditional kwargs include...\n\nkwarg DataType description default\nburnin Int number of Markov chain burnin-warm-up steps 10\nchainsteps Int number of recorded Markov chains steps 10\nk Constants constants and coefficients used in diffusion-advection calculations Constants()\nseawater Water seawater composition overlying sediment column mcmurdosound()\nexplore Tuple{Vararg{Symbol}} parameters explored by the MCMC fieldnames(Proposal)\nrng AbstractRNG optional random number seed Random.Xoshiro()\n\nsee also: Proposal, CoreData, ClimateHistory, Constants, Water\n\n\n\n\n\n","category":"method"},{"location":"#CorePore.proposaljump-Tuple{Proposal, Proposal}","page":"Home","title":"CorePore.proposaljump","text":"CorePore.proposaljump(p::Proposal, σ::Proposal; f, rng::AbstractRNG)\n\nAdd a random jump to a randomly selected field of p with a corresponding normal jumping distribution defined by the corresponding field in σ. The possible fields may be specified by providing a Tuple of Symbols f (default=fieldnames(Proposal)), and a specific RNG seed may be provided.\n\nNote that :dmlt, :dfrz, and :basalCl are drawn from a lognormal jumping distribution (where σ is in log-space.)\n\nsee also: porewatermetropolis, Proposal\n\n\n\n\n\n","category":"method"},{"location":"#CorePore.stopwatch-Tuple{Integer, Integer, Number}","page":"Home","title":"CorePore.stopwatch","text":"stopwatch(i, n, t)\n\nConvenience function for [porewatermetropolis] that returns a String reporting the progress at step i for total steps n with start time t (in s since the epoch).\n\n\n\n\n\n","category":"method"},{"location":"#CorePore.strictpriors-Tuple{Proposal, Number, Tuple{Number, Number}, Number}","page":"Home","title":"CorePore.strictpriors","text":"CorePore.strictpriors(p::Proposal, record_max_age::Number, climatelimits::Tuple{Number,Number}, depth::Number)\n\nEvalute strict constraints on priors that will automatically reject a proposal with...\n\nOnset date beyond the climate record timespan (in ka) (record_max_age)\nNonphysical subglacial thresholds – melting at lower benthic δ¹⁸O than freezing or values exceeding the record extrema (climatelimits).\nFreezing rate is non-zero and less than the upperbound of observed freezing rates (0.002 m/yr)\nAnnual melting rate is non-zero and must be no more than that observed at the Thwaites grounding line (<10 m/yr, Davis+ 2023).\nDiffusive porewater column (p.flr) is between 0 and the model sediment column depth.\nBasal [Cl⁻] compositions < 0 g/kg or in excess of 200 g/kg (the water+halite peritectic is ~163 g/kg Cl, assuming charge balance with NaCl)\nδ¹⁸O compositions less than dome-like values (~ -56 ‰)\n\n\n\n\n\n","category":"method"},{"location":"#CorePore.update-Tuple{Proposal, Symbol, Number}","page":"Home","title":"CorePore.update","text":"update(p::Proposal, f::Symbol, x::Number)\n\nUpdate field f of Proposal instance p with value x.\n\n\n\n\n\n","category":"method"},{"location":"#CorePore.velocity-Tuple{Any, Any, Any}","page":"Home","title":"CorePore.velocity","text":"velocity(x, above, k)\n\nCalculate the velocity (m/yr) at a node with density x, given the density of the node above, and the hydraulic conductivity k (m/yr).\n\nsee also: density\n\n\n\n\n\n","category":"method"}]
}

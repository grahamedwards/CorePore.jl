<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Home · CorePore.jl</title><meta name="title" content="Home · CorePore.jl"/><meta property="og:title" content="Home · CorePore.jl"/><meta property="twitter:title" content="Home · CorePore.jl"/><meta name="description" content="Documentation for CorePore.jl."/><meta property="og:description" content="Documentation for CorePore.jl."/><meta property="twitter:description" content="Documentation for CorePore.jl."/><meta property="og:url" content="https://grahamedwards.github.io/CorePore.jl/"/><meta property="twitter:url" content="https://grahamedwards.github.io/CorePore.jl/"/><link rel="canonical" href="https://grahamedwards.github.io/CorePore.jl/"/><script data-outdated-warner src="assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="assets/documenter.js"></script><script src="search_index.js"></script><script src="siteinfo.js"></script><script src="../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href>CorePore.jl</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li class="is-active"><a class="tocitem" href>Home</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li class="is-active"><a href>Home</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Home</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/grahamedwards/CorePore.jl/blob/main/docs/src/index.md#" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="CorePore"><a class="docs-heading-anchor" href="#CorePore">CorePore</a><a id="CorePore-1"></a><a class="docs-heading-anchor-permalink" href="#CorePore" title="Permalink"></a></h1><p>Documentation for <a href="https://github.com/grahamedwards/CorePore.jl">CorePore</a>.</p><ul><li><a href="#CorePore.ClimateHistory"><code>CorePore.ClimateHistory</code></a></li><li><a href="#CorePore.Constants"><code>CorePore.Constants</code></a></li><li><a href="#CorePore.CoreData"><code>CorePore.CoreData</code></a></li><li><a href="#CorePore.PorewaterProperty"><code>CorePore.PorewaterProperty</code></a></li><li><a href="#CorePore.Proposal"><code>CorePore.Proposal</code></a></li><li><a href="#CorePore.ProposalPriors"><code>CorePore.ProposalPriors</code></a></li><li><a href="#CorePore.SedimentColumn"><code>CorePore.SedimentColumn</code></a></li><li><a href="#CorePore.Water"><code>CorePore.Water</code></a></li><li><a href="#CorePore.LR04-Tuple{}"><code>CorePore.LR04</code></a></li><li><a href="#CorePore.andrill1b-Tuple{}"><code>CorePore.andrill1b</code></a></li><li><a href="#CorePore.andrill2a-Tuple{}"><code>CorePore.andrill2a</code></a></li><li><a href="#CorePore.boundaryconditions-Tuple{Float64, Float64, Vararg{Any, 9}}"><code>CorePore.boundaryconditions</code></a></li><li><a href="#CorePore.checkpriors-Tuple{Proposal, ProposalPriors}"><code>CorePore.checkpriors</code></a></li><li><a href="#CorePore.chlordiffuseadvectcolumn!-Tuple{SedimentColumn, Constants, Float64}"><code>CorePore.chlordiffuseadvectcolumn!</code></a></li><li><a href="#CorePore.chlorporewaterhistory!-Tuple{SedimentColumn, Proposal, Constants, CorePore.ClimateHistory, Water, Int64}"><code>CorePore.chlorporewaterhistory!</code></a></li><li><a href="#CorePore.deepbonney-Tuple{}"><code>CorePore.deepbonney</code></a></li><li><a href="#CorePore.density-Tuple{Any}"><code>CorePore.density</code></a></li><li><a href="#CorePore.diffuseadvectcolumn!-Tuple{SedimentColumn, Constants, Float64}"><code>CorePore.diffuseadvectcolumn!</code></a></li><li><a href="#CorePore.diffusion-NTuple{4, Any}"><code>CorePore.diffusion</code></a></li><li><a href="#CorePore.diffusionadvection-NTuple{8, Any}"><code>CorePore.diffusionadvection</code></a></li><li><a href="#CorePore.dt_climatetimestep-Tuple{AbstractRange, Number}"><code>CorePore.dt_climatetimestep</code></a></li><li><a href="#CorePore.equilibratecolumn!-Tuple{SedimentColumn, Water, Water, StepRangeLen, Float64}"><code>CorePore.equilibratecolumn!</code></a></li><li><a href="#CorePore.fastsplat-Tuple{Proposal}"><code>CorePore.fastsplat</code></a></li><li><a href="#CorePore.linterp-NTuple{5, Any}"><code>CorePore.linterp</code></a></li><li><a href="#CorePore.loglikelihood-Union{Tuple{T}, Tuple{T, T, T, AbstractRange{Float64}, T}} where T&lt;:Vector{Float64}"><code>CorePore.loglikelihood</code></a></li><li><a href="#CorePore.mcmurdoshelf-Tuple{}"><code>CorePore.mcmurdoshelf</code></a></li><li><a href="#CorePore.mcmurdosound-Tuple{}"><code>CorePore.mcmurdosound</code></a></li><li><a href="#CorePore.means-Tuple{NamedTuple}"><code>CorePore.means</code></a></li><li><a href="#CorePore.medians-Tuple{Any}"><code>CorePore.medians</code></a></li><li><a href="#CorePore.normll-Tuple{Float64, Float64, Float64}"><code>CorePore.normll</code></a></li><li><a href="#CorePore.normpdf-Tuple{Number, Number, Number}"><code>CorePore.normpdf</code></a></li><li><a href="#CorePore.porewaterhistory-Tuple{Proposal}"><code>CorePore.porewaterhistory</code></a></li><li><a href="#CorePore.porewaterhistory!-Tuple{SedimentColumn, Proposal, Constants, CorePore.ClimateHistory, Water, Int64}"><code>CorePore.porewaterhistory!</code></a></li><li><a href="#CorePore.porewatermetropolis-Tuple{Proposal, Proposal, ProposalPriors, CoreData, CorePore.ClimateHistory, Constants}"><code>CorePore.porewatermetropolis</code></a></li><li><a href="#CorePore.proposaljump-Tuple{Proposal, Proposal}"><code>CorePore.proposaljump</code></a></li><li><a href="#CorePore.stopwatch-Tuple{Integer, Integer, Number}"><code>CorePore.stopwatch</code></a></li><li><a href="#CorePore.strictpriors-Tuple{Proposal, Number, Tuple{Number, Number}, Number}"><code>CorePore.strictpriors</code></a></li><li><a href="#CorePore.update-Tuple{Proposal, Symbol, Number}"><code>CorePore.update</code></a></li><li><a href="#CorePore.velocity-Tuple{Any, Any, Any}"><code>CorePore.velocity</code></a></li></ul><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="CorePore.ClimateHistory" href="#CorePore.ClimateHistory"><code>CorePore.ClimateHistory</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">ClimateHistory</code></pre><p>Custom struct to contain a climate record <code>x</code> over timescale <code>t</code>, where <code>t</code> contains <code>n</code> timesteps.</p><p>The type generated by <a href="#CorePore.LR04-Tuple{}"><code>LR04</code></a>, which is used for (perhaps unnecessary) type stability and code readability.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/grahamedwards/CorePore.jl/blob/cf002a04f35bb2cee5714eb1a6e1b0ddaef681b3/src/parameters.jl#L240-L248">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="CorePore.Constants" href="#CorePore.Constants"><code>CorePore.Constants</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">Constants( ; k, dt, dz, depth )</code></pre><p>Returns a <code>Constants</code> struct containing constants and coefficients used in diffusion history calculations. The inputs and their default values are listed in the table below. From these it calculates a few convenient variables–-the product <code>dt * dz</code> (<code>dtdz</code>), a Range of node depths <code>z</code> (in m), the number of nodes <code>nz</code>, and the <code>penultimate_node</code>–-as well as temperature-dependent diffusion coefficients used in <code>diffusionadvection</code>, using the temperature-depth paramterization of <a href="https://doi.org/10.1130/GES00512.1">Morin+ 2010</a>. These are returned as Vectors of length <code>nz</code>, where each cell corresponds to a depth node in <code>z</code>. The two coefficients are <code>k1</code> and <code>k2</code>, both of which are follwed with <code>cl</code> or <code>w</code> to denote Cl⁻ or water, respectively: <code>k1cl</code>, <code>k2cl</code>, <code>k1w</code>, and <code>k2w</code>.</p><table><tr><th style="text-align: left">field</th><th style="text-align: left">description</th><th style="text-align: right">default</th></tr><tr><td style="text-align: left"><code>k</code></td><td style="text-align: left">hydraulic conductivity of sediment column</td><td style="text-align: right">0.1 m / yr</td></tr><tr><td style="text-align: left"><code>dt</code></td><td style="text-align: left">timestep</td><td style="text-align: right">10 yrs</td></tr><tr><td style="text-align: left"><code>dz</code></td><td style="text-align: left">node spacing</td><td style="text-align: right">5 m</td></tr><tr><td style="text-align: left"><code>depth</code></td><td style="text-align: left">sediment column depth</td><td style="text-align: right">2000 m</td></tr></table></div><a class="docs-sourcelink" target="_blank" href="https://github.com/grahamedwards/CorePore.jl/blob/cf002a04f35bb2cee5714eb1a6e1b0ddaef681b3/src/parameters.jl#L259-L274">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="CorePore.CoreData" href="#CorePore.CoreData"><code>CorePore.CoreData</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">CoreData(z, mCl, σCl, mO, σO)</code></pre><p>Returns an  <code>CoreData</code> struct with sediment core data formatted for <a href="#CorePore.porewatermetropolis-Tuple{Proposal, Proposal, ProposalPriors, CoreData, CorePore.ClimateHistory, Constants}"><code>porewatermetropolis</code></a> — <code>(; z, Cl = (mu, sig), O = (mu, sig))</code>. Inputs are Vectors for values of sample depths <code>z</code> (meters below sea floor), measured (mean) chlorinity <code>mCl</code> and 1σ uncertainty <code>σCl</code>, and measured (mean) δ¹⁸O <code>mO</code> and 1σ uncertainties <code>σO</code>. </p><p>Vectors must all be of the same length. If Cl and δ¹⁸O sampling is not 1:1, use <code>NaN</code> or anything that is not a subtype of Number (e.g. <code>missing</code>, <code>nothing</code>). While <code>NaN</code> is used internally, <code>CoreData</code> does this conversion for you.</p><hr/><pre><code class="nohighlight hljs">CoreData(z, m, σ, measurement)</code></pre><p>Same as above, but for a core with only chlorinity or δ¹⁸O data (the other Vectors are empty to return null values in <a href="#CorePore.loglikelihood-Union{Tuple{T}, Tuple{T, T, T, AbstractRange{Float64}, T}} where T&lt;:Vector{Float64}"><code>loglikelihood</code></a> calculations). Provide sample depths <code>z</code>, measured means <code>m</code>, 1σ uncertainties <code>σ</code>, and the <code>measurement</code> as a symbol, e.g. <code>:Cl</code> or <code>:O</code>. </p><hr/><p><code>CorePore.jl</code> comes loaded with convenience functions to generate data for <a href="#CorePore.andrill2a-Tuple{}"><code>andrill2a</code></a> from Tracy+ 2010 (<a href="https://doi.org/10.1130/G30849.1">doi:10.1130/G30849.1</a>) and <a href="#CorePore.andrill1b-Tuple{}"><code>andrill1b</code></a> from Pompilio+ 2007 (https://digitalcommons.unl.edu/andrillrespub/37). </p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/grahamedwards/CorePore.jl/blob/cf002a04f35bb2cee5714eb1a6e1b0ddaef681b3/src/parameters.jl#L61-L79">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="CorePore.PorewaterProperty" href="#CorePore.PorewaterProperty"><code>CorePore.PorewaterProperty</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">PorewaterProperty(n::Int, [, x])</code></pre><p><code>struct</code> to contain sediment column poperties at each node for the previous timestep <code>o</code> and present timestep <code>p</code>.</p><p>Constructor function returns an instance of <code>PorewaterProperty</code> with vectors of length <code>n</code>.  Optionally provide a value <code>x &lt;: Number</code> to fill vectors with (otherwise values are undefined). </p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/grahamedwards/CorePore.jl/blob/cf002a04f35bb2cee5714eb1a6e1b0ddaef681b3/src/parameters.jl#L168-L176">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="CorePore.Proposal" href="#CorePore.Proposal"><code>CorePore.Proposal</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">Proposal</code></pre><p>Struct containing porewater parameters (described below). All inputs must be of type Number (converts to Float64). Built-in functionality includes splatting (<code>...</code>) and <a href="#CorePore.fastsplat-Tuple{Proposal}"><code>CorePore.fastsplat</code></a>.</p><table><tr><th style="text-align: left">field</th><th style="text-align: left">description</th><th style="text-align: left">units</th><th style="text-align: left">default</th></tr><tr><td style="text-align: left"><code>onset</code></td><td style="text-align: left">onset of model</td><td style="text-align: left">ka</td><td style="text-align: left">5320</td></tr><tr><td style="text-align: left"><code>dfrz</code></td><td style="text-align: left">freezing rate</td><td style="text-align: left">m/yr</td><td style="text-align: left">0.0001</td></tr><tr><td style="text-align: left"><code>dmlt</code></td><td style="text-align: left">melting rate</td><td style="text-align: left">m/yr</td><td style="text-align: left">0.001</td></tr><tr><td style="text-align: left"><code>sea2frz</code></td><td style="text-align: left">Benthic δ¹⁸O threshold for subglacial freezing</td><td style="text-align: left">‰</td><td style="text-align: left">3.5</td></tr><tr><td style="text-align: left"><code>frz2mlt</code></td><td style="text-align: left">Benthic δ¹⁸O threshold for subglacial melting</td><td style="text-align: left">‰</td><td style="text-align: left">4.2</td></tr><tr><td style="text-align: left"><code>flr</code></td><td style="text-align: left">depth of diffusion-dominated porewater column</td><td style="text-align: left">m</td><td style="text-align: left">1000.</td></tr><tr><td style="text-align: left"><code>basalCl</code></td><td style="text-align: left">chloridity at base of diffusion-dominated column</td><td style="text-align: left">g/kg</td><td style="text-align: left">119.4</td></tr><tr><td style="text-align: left"><code>basalO</code></td><td style="text-align: left">δ¹⁸O at base of diffusion-dominated column</td><td style="text-align: left">‰</td><td style="text-align: left">-25.2</td></tr></table><p>see also: <a href="#CorePore.update-Tuple{Proposal, Symbol, Number}"><code>update</code></a></p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/grahamedwards/CorePore.jl/blob/cf002a04f35bb2cee5714eb1a6e1b0ddaef681b3/src/parameters.jl#L322-L341">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="CorePore.ProposalPriors" href="#CorePore.ProposalPriors"><code>CorePore.ProposalPriors</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">ProposalPriors(climate, k; onset, dfrz, fmlt, climatelimits, flr, basalCl, basalO)</code></pre><p>Custom <code>struct</code> to hold the bounds of parameters in Proposal as <code>Tuple</code>s of (<code>minimum value</code>, <code>maximum value</code>). The constructor function takes a <a href="#CorePore.ClimateHistory"><code>ClimateHistory</code></a> instance <code>climate</code> and <a href="#CorePore.Constants"><code>Constants</code></a> instance <code>k</code>, as well as any customizations to default values.</p><hr/><p><strong>Fields</strong></p><p>See <a href="#CorePore.Proposal"><code>Proposal</code></a> for descriptions and units of shared parameters.</p><table><tr><th style="text-align: left">field</th><th style="text-align: left">default</th><th style="text-align: left">explanation</th></tr><tr><td style="text-align: left"><code>onset</code></td><td style="text-align: left">(<code>0</code>, <code>first(climate.t)</code>)</td><td style="text-align: left">Onset date must fall within climate record timespan.</td></tr><tr><td style="text-align: left"><code>dfrz</code></td><td style="text-align: left">(<code>0</code>, <code>0.002</code>)</td><td style="text-align: left">Freezing rate is non-zero and less than the upperbound of observed freezing rates (0.002 m/yr).¹</td></tr><tr><td style="text-align: left"><code>dmlt</code></td><td style="text-align: left">(<code>0</code>, <code>10</code>)</td><td style="text-align: left">Annual melting rate is non-zero and must be no more than that observed at the Thwaites grounding line.²</td></tr><tr><td style="text-align: left"><code>climatelimits</code></td><td style="text-align: left"><code>extrema(climate.x)</code></td><td style="text-align: left"><code>sea2frz</code> and <code>frz2mlt</code> must lie within the observed climate record values.</td></tr><tr><td style="text-align: left"><code>flr</code></td><td style="text-align: left">(<code>0</code>, <code>k.depth</code>)</td><td style="text-align: left">Diffusive porewater column (<code>p.flr</code>) has non-zero depth within model domain.</td></tr><tr><td style="text-align: left"><code>basalCl</code></td><td style="text-align: left">(<code>0</code>, <code>200</code>)</td><td style="text-align: left">Basal [Cl⁻] compositions within 0-200 g/kg. (³)</td></tr><tr><td style="text-align: left"><code>basalO</code></td><td style="text-align: left">(<code>-56</code>, <code>∞</code>)</td><td style="text-align: left">δ¹⁸O exceed dome-like values.</td></tr><tr><td style="text-align: left"></td><td style="text-align: left"></td><td style="text-align: left"></td></tr></table><p>¹ Must be  ≤ 0.4dt/dz to prevent an error in a log-calculation in <code>CorePore.boundaryconditions</code></p><p>² &lt;10 m/yr – Davis+ 2023, https://www.nature.com/articles/s41586-022-05586-0</p><p>³ The water+halite peritectic is ~163 g/kg Cl, assuming charge balance with NaCl.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/grahamedwards/CorePore.jl/blob/cf002a04f35bb2cee5714eb1a6e1b0ddaef681b3/src/parameters.jl#L398-L428">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="CorePore.SedimentColumn" href="#CorePore.SedimentColumn"><code>CorePore.SedimentColumn</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">SedimentColumn(n::Int, [, Cl, O])</code></pre><p><code>struct</code> to contain <code>PorewaterProperty</code>s for the porewater properties of chloridity (<code>Cl</code>), δ¹⁸O (<code>O</code>), and density (<code>rho</code>).</p><p>Constructor function returns an instance of <code>SedimentColumn</code> with <code>PorewaterProperty</code> vectors of length <code>n</code>.  Optionally provide values for <code>Cl</code>, <code>O</code>, and <code>rho</code> (otherwise values are undefined). </p><p>see also: <a href="#CorePore.PorewaterProperty"><code>PorewaterProperty</code></a>, <a href="#CorePore.density-Tuple{Any}"><code>density</code></a></p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/grahamedwards/CorePore.jl/blob/cf002a04f35bb2cee5714eb1a6e1b0ddaef681b3/src/parameters.jl#L193-L203">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="CorePore.Water" href="#CorePore.Water"><code>CorePore.Water</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">water(Cl, O)</code></pre><p>Custom <code>struct</code> containing <code>Float64</code> values of chlorinity <code>Cl</code> and δ¹⁸O <code>O</code>. Built-in splatting functionality.</p><p>see also: <a href="#CorePore.mcmurdoshelf-Tuple{}"><code>mcmurdoshelf</code></a>, <a href="#CorePore.mcmurdosound-Tuple{}"><code>mcmurdosound</code></a></p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/grahamedwards/CorePore.jl/blob/cf002a04f35bb2cee5714eb1a6e1b0ddaef681b3/src/parameters.jl#L3-L11">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="CorePore.LR04-Tuple{}" href="#CorePore.LR04-Tuple{}"><code>CorePore.LR04</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">LR04()</code></pre><p>Generate a <a href="#CorePore.ClimateHistory"><code>ClimateHistory</code></a> instance containing the Liesiecki &amp; Raymo 2004 benthic stack (<a href="https://lorraine-lisiecki.com/stack.html">data</a>, <a href="https://doi.org/10.1029/2004PA001071">publication</a>) interpolated for 1 ka timesteps and going forward in time from 5.32 Ma. </p><table><tr><th style="text-align: left">field</th><th style="text-align: left">description</th></tr><tr><td style="text-align: left"><code>t</code></td><td style="text-align: left">time (ka)</td></tr><tr><td style="text-align: left"><code>x</code></td><td style="text-align: left">benthic δ¹⁸O (‰)</td></tr><tr><td style="text-align: left"><code>n</code></td><td style="text-align: left">timesteps in <code>t</code></td></tr></table></div><a class="docs-sourcelink" target="_blank" href="https://github.com/grahamedwards/CorePore.jl/blob/cf002a04f35bb2cee5714eb1a6e1b0ddaef681b3/src/parameters.jl#L216-L228">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="CorePore.andrill1b-Tuple{}" href="#CorePore.andrill1b-Tuple{}"><code>CorePore.andrill1b</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">andrill1b</code></pre><p>Generate a <a href="#CorePore.CoreData"><code>CoreData</code></a> instance with data from core ANDRILL-1B (from Pompilio+ 2007 (https://digitalcommons.unl.edu/andrillrespub/37)). </p><p>see also: <a href="#CorePore.CoreData"><code>CoreData</code></a></p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/grahamedwards/CorePore.jl/blob/cf002a04f35bb2cee5714eb1a6e1b0ddaef681b3/src/parameters.jl#L144-L152">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="CorePore.andrill2a-Tuple{}" href="#CorePore.andrill2a-Tuple{}"><code>CorePore.andrill2a</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">andrill2a</code></pre><p>Generate a <a href="#CorePore.CoreData"><code>CoreData</code></a> instance with data from core ANDRILL-2A (from Frank+ 2010, <a href="https://doi.org/10.1130/G30849.1">doi:10.1130/G30849.1</a>). </p><p>see also: <a href="#CorePore.CoreData"><code>CoreData</code></a></p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/grahamedwards/CorePore.jl/blob/cf002a04f35bb2cee5714eb1a6e1b0ddaef681b3/src/parameters.jl#L119-L127">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="CorePore.boundaryconditions-Tuple{Float64, Float64, Vararg{Any, 9}}" href="#CorePore.boundaryconditions-Tuple{Float64, Float64, Vararg{Any, 9}}"><code>CorePore.boundaryconditions</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">function boundaryconditions(Cl, d18O, x, sea2freeze,freeze2melt, meltrate, freezerate, Clsw, d18Osw, dz, dt)</code></pre><p>Calculates sediment surface boundary condition for δ¹⁸O (<code>d18O</code>) and chloridity (<code>Cl</code>), based on the thermodynamic state described by the current current benthic δ¹⁸O value <code>x</code> and the threshold values corresponding to subglacial freezing <code>sea2freeze</code> and subglacial melting <code>freeze2melt</code>.</p><p>For melting or freezing states, calculates boundary condition from the assumed <code>meltrate</code>, <code>freezerate</code>, timestep <code>dt</code>, length-step <code>dt</code>, and composition of seawater <code>Clsw</code> and <code>d18Osw</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/grahamedwards/CorePore.jl/blob/cf002a04f35bb2cee5714eb1a6e1b0ddaef681b3/src/diffuse.jl#L7-L16">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="CorePore.checkpriors-Tuple{Proposal, ProposalPriors}" href="#CorePore.checkpriors-Tuple{Proposal, ProposalPriors}"><code>CorePore.checkpriors</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">checkpriors(p::Proposal, pp::ProposalPriors)</code></pre><p>Returns <code>false</code> if any proposal value <code>p</code> falls beyond the prescribed prior bounds in <code>pp</code>, or if proposed subglacial thresholds are non-physical, i.e. melting at lower benthic δ¹⁸O than freezing.</p><p>Otherwise returns <code>true</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/grahamedwards/CorePore.jl/blob/cf002a04f35bb2cee5714eb1a6e1b0ddaef681b3/src/metropolis.jl#L38-L46">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="CorePore.chlordiffuseadvectcolumn!-Tuple{SedimentColumn, Constants, Float64}" href="#CorePore.chlordiffuseadvectcolumn!-Tuple{SedimentColumn, Constants, Float64}"><code>CorePore.chlordiffuseadvectcolumn!</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">chlordiffuseadvectcolumn!(sc, k, flr)</code></pre><p>Same as <a href="#CorePore.diffuseadvectcolumn!-Tuple{SedimentColumn, Constants, Float64}"><code>diffuseadvectcolumn!</code></a>, but skipping δ¹⁸O calculations. </p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/grahamedwards/CorePore.jl/blob/cf002a04f35bb2cee5714eb1a6e1b0ddaef681b3/src/diffuse.jl#L140-L148">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="CorePore.chlorporewaterhistory!-Tuple{SedimentColumn, Proposal, Constants, CorePore.ClimateHistory, Water, Int64}" href="#CorePore.chlorporewaterhistory!-Tuple{SedimentColumn, Proposal, Constants, CorePore.ClimateHistory, Water, Int64}"><code>CorePore.chlorporewaterhistory!</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">chlorporewaterhistory!(sc, p, k, climhist, seawater, ka_dt)</code></pre><p>Same as <a href="#CorePore.porewaterhistory-Tuple{Proposal}"><code>porewaterhistory</code></a>, but skipping δ¹⁸O calculations. </p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/grahamedwards/CorePore.jl/blob/cf002a04f35bb2cee5714eb1a6e1b0ddaef681b3/src/history.jl#L33-L41">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="CorePore.deepbonney-Tuple{}" href="#CorePore.deepbonney-Tuple{}"><code>CorePore.deepbonney</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">deepbonney()

Generate a [`Water`](@ref) instance with &gt;30 m Lake Bonney water compositions. Use for sediment column basal boundary condition. Chloridity (143.333 g/L  ÷ 1.2 kg/L ≈ 119 g/kg) from Angino+ 1963 ([doi:10.1086/626879](https://doi.org/10.1086/626879)) and δ¹⁸O from Matsubaya+ 1979 ([doi:10.1016/0016-7037(79)90042-5](https://doi.org/10.1016/0016-7037(79)90042-5)).</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/grahamedwards/CorePore.jl/blob/cf002a04f35bb2cee5714eb1a6e1b0ddaef681b3/src/parameters.jl#L44-L50">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="CorePore.density-Tuple{Any}" href="#CorePore.density-Tuple{Any}"><code>CorePore.density</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">density(chlorinity)</code></pre><p>Calculates the density of a water parcel with <code>chlorinity</code> in units g/m³ (rather than kg/m³ for convenience with <code>velocity</code>)</p><p>see also: <a href="#CorePore.velocity-Tuple{Any, Any, Any}"><code>velocity</code></a></p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/grahamedwards/CorePore.jl/blob/cf002a04f35bb2cee5714eb1a6e1b0ddaef681b3/src/diffuse.jl#L64-L72">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="CorePore.diffuseadvectcolumn!-Tuple{SedimentColumn, Constants, Float64}" href="#CorePore.diffuseadvectcolumn!-Tuple{SedimentColumn, Constants, Float64}"><code>CorePore.diffuseadvectcolumn!</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">diffuseadvectcolumn!(sc, k, flr)</code></pre><p>Calculate diffusive and advective transport of chlorinity and isotope-traced water through a sediment column described by properties in <code>k</code>, a NamedTuple generated by the <a href="#CorePore.Constants"><code>Constants</code></a> function.</p><p>Overwrites the <code>o</code> and <code>p</code> PorewaterProperty fields of <code>sc</code> – a <a href="#CorePore.SedimentColumn"><code>SedimentColumn</code></a> with pre-existing conditions of <code>Cl</code>, <code>O</code>, and <code>rho</code> in its <code>o</code> fields.</p><p>relies on: <a href="#CorePore.velocity-Tuple{Any, Any, Any}"><code>velocity</code></a>, <a href="#CorePore.density-Tuple{Any}"><code>density</code></a>, <a href="#CorePore.diffusionadvection-NTuple{8, Any}"><code>diffusionadvection</code></a>, </p><p>see also: <a href="#CorePore.SedimentColumn"><code>SedimentColumn</code></a>, <a href="#CorePore.Constants"><code>Constants</code></a> </p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/grahamedwards/CorePore.jl/blob/cf002a04f35bb2cee5714eb1a6e1b0ddaef681b3/src/diffuse.jl#L93-L107">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="CorePore.diffusion-NTuple{4, Any}" href="#CorePore.diffusion-NTuple{4, Any}"><code>CorePore.diffusion</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">diffusion(x,above,below,k)</code></pre><p>Calculate the property of a node in a vertical profile given the effect of diffusion, alone. Returns the property given initial values for the node <code>x</code>, the overlying node <code>above</code>, the underlying node <code>below</code>, and (<code>dt</code>/<code>dz</code>²-scaled) diffusion coefficient <code>k</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/grahamedwards/CorePore.jl/blob/cf002a04f35bb2cee5714eb1a6e1b0ddaef681b3/src/diffuse.jl#L54-L60">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="CorePore.diffusionadvection-NTuple{8, Any}" href="#CorePore.diffusionadvection-NTuple{8, Any}"><code>CorePore.diffusionadvection</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">diffusionadvection(x,above,below,k1,k2,v,dt,dz)</code></pre><p>Calculate the property of a node in a vertical profile given the combined effects of diffusion and advection. Returns the property given initial values for the node <code>x</code>, the overlying node <code>above</code>, the underlying node <code>below</code>, (<code>dt</code>/<code>dz</code>-scaled) diffusion coefficients <code>k1</code> and <code>k2</code>, vertical advection velocity <code>v</code>, timestep <code>dt</code>, and lengthstep <code>dz</code>. Alternatively provide the product of <code>v * dt * dz</code> for a minor speed-up.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/grahamedwards/CorePore.jl/blob/cf002a04f35bb2cee5714eb1a6e1b0ddaef681b3/src/diffuse.jl#L42-L48">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="CorePore.dt_climatetimestep-Tuple{AbstractRange, Number}" href="#CorePore.dt_climatetimestep-Tuple{AbstractRange, Number}"><code>CorePore.dt_climatetimestep</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">dt_climatetimestep(katime,dt)</code></pre><p>A helper function to calculate the number of diffusion model timesteps <code>dt</code> (in years) in each timestep of the climate timescale <code>katime</code> (in kiloannum). Returns an integer. </p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/grahamedwards/CorePore.jl/blob/cf002a04f35bb2cee5714eb1a6e1b0ddaef681b3/src/history.jl#L92-L98">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="CorePore.equilibratecolumn!-Tuple{SedimentColumn, Water, Water, StepRangeLen, Float64}" href="#CorePore.equilibratecolumn!-Tuple{SedimentColumn, Water, Water, StepRangeLen, Float64}"><code>CorePore.equilibratecolumn!</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">equilibratecolumn!(sc, seawater, basalwater, z, flr)</code></pre><p>Calculate an equilibrium linear profile for all SedimentColumn vectors in <code>sc</code> between a seafloor <code>seawater</code> and <code>basalwater</code> composition, given node depths <code>z</code> and diffusion-dominated column depth <code>flr</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/grahamedwards/CorePore.jl/blob/cf002a04f35bb2cee5714eb1a6e1b0ddaef681b3/src/diffuse.jl#L177-L185">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="CorePore.fastsplat-Tuple{Proposal}" href="#CorePore.fastsplat-Tuple{Proposal}"><code>CorePore.fastsplat</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">fastsplat(x::Proposal)</code></pre><p>Returns a tuple of the contents of <code>x</code>. Avoids type inherent instability of <code>Base.iterate</code> for fast splatting.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/grahamedwards/CorePore.jl/blob/cf002a04f35bb2cee5714eb1a6e1b0ddaef681b3/src/parameters.jl#L389-L393">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="CorePore.linterp-NTuple{5, Any}" href="#CorePore.linterp-NTuple{5, Any}"><code>CorePore.linterp</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">linterp(x, x₁, Δx, y₂, y₁ )</code></pre><p>Estimate the value of y corresponding to <code>x</code> given known coordinate (<code>x₁</code>, <code>y₁</code>), value <code>y₂</code>, and <code>Δx</code>= x₂ - x₁. Note that if <code>x</code>==<code>x₁</code>, y= <code>y₁</code>. </p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/grahamedwards/CorePore.jl/blob/cf002a04f35bb2cee5714eb1a6e1b0ddaef681b3/src/statistics.jl#L27-L33">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="CorePore.loglikelihood-Union{Tuple{T}, Tuple{T, T, T, AbstractRange{Float64}, T}} where T&lt;:Vector{Float64}" href="#CorePore.loglikelihood-Union{Tuple{T}, Tuple{T, T, T, AbstractRange{Float64}, T}} where T&lt;:Vector{Float64}"><code>CorePore.loglikelihood</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">loglikelihood( zₒ, μ, σ, zₘ, m )</code></pre><p>Calculate the (relative) log-likelihood that model values in <code>m</code> simulated at depth nodes in <code>zₘ</code> were drawn from normally distributed observations with sample depths, mean values, and 1σ uncertainties in corresponding indices of the Vectors <code>zₒ</code>, <code>μₒ</code>, and <code>σ</code>. The simulated value is linearly interpolated between bounding depth nodes in <code>zₘ</code>.</p><p>see also: <a href="#CorePore.normll-Tuple{Float64, Float64, Float64}"><code>normll</code></a>, <a href="#CorePore.linterp-NTuple{5, Any}"><code>linterp</code></a></p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/grahamedwards/CorePore.jl/blob/cf002a04f35bb2cee5714eb1a6e1b0ddaef681b3/src/statistics.jl#L41-L48">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="CorePore.mcmurdoshelf-Tuple{}" href="#CorePore.mcmurdoshelf-Tuple{}"><code>CorePore.mcmurdoshelf</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">mcmurdoshelf()</code></pre><p>Generate a <a href="#CorePore.Water"><code>Water</code></a> instance with coretop porewater compositions from the McMurdo ice shelf. Pairs with core ANDRILL-1B.</p><p>see also: <a href="#CorePore.andrill1b-Tuple{}"><code>andrill1b</code></a></p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/grahamedwards/CorePore.jl/blob/cf002a04f35bb2cee5714eb1a6e1b0ddaef681b3/src/parameters.jl#L24-L31">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="CorePore.mcmurdosound-Tuple{}" href="#CorePore.mcmurdosound-Tuple{}"><code>CorePore.mcmurdosound</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">mcmurdosound()</code></pre><p>Generate a <a href="#CorePore.Water"><code>Water</code></a> instance with southern McMurdo Sound water compositions. Pair with core ANDRILL-2A.</p><p>see also:  <a href="#CorePore.andrill2a-Tuple{}"><code>andrill2a</code></a></p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/grahamedwards/CorePore.jl/blob/cf002a04f35bb2cee5714eb1a6e1b0ddaef681b3/src/parameters.jl#L34-L41">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="CorePore.means-Tuple{NamedTuple}" href="#CorePore.means-Tuple{NamedTuple}"><code>CorePore.means</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">means(x; std::Integer)</code></pre><p>Calculate the means of each field in NamedTuple <code>x</code>. Optionally provide an integer number of standard deviations to calculate, returned as the form <code>key</code> = (m=μ, s=σ). Use with the returned chains of <a href="#CorePore.porewatermetropolis-Tuple{Proposal, Proposal, ProposalPriors, CoreData, CorePore.ClimateHistory, Constants}"><code>porewatermetropolis</code></a>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/grahamedwards/CorePore.jl/blob/cf002a04f35bb2cee5714eb1a6e1b0ddaef681b3/src/statistics.jl#L64-L70">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="CorePore.medians-Tuple{Any}" href="#CorePore.medians-Tuple{Any}"><code>CorePore.medians</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">medians(x; ci::Float64)</code></pre><p>Calculate the medians of each field in NamedTuple <code>x</code>. Optionally provide a <code>ci</code> ∈ [0,1] of standard deviations to calculate, returned as the form <code>key</code> = (m=median, l=lower, u=upper). Use with the returned chains of <a href="#CorePore.porewatermetropolis-Tuple{Proposal, Proposal, ProposalPriors, CoreData, CorePore.ClimateHistory, Constants}"><code>porewatermetropolis</code></a>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/grahamedwards/CorePore.jl/blob/cf002a04f35bb2cee5714eb1a6e1b0ddaef681b3/src/statistics.jl#L83-L89">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="CorePore.normll-Tuple{Float64, Float64, Float64}" href="#CorePore.normll-Tuple{Float64, Float64, Float64}"><code>CorePore.normll</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">normll(x, μ, σ)</code></pre><p>Calculate the (relative) log-likelihood that an observation <code>x</code> was drawn from the normal distribution with mean <code>μ</code> and standard deviation <code>σ</code>. If <code>μ</code> is a NaN (instead of missing for type homogeneity), returns <code>0</code>.</p><p>Note: This function excludes a constant that will not vary for different vlaues of <code>x</code> to speed up calculation in <code>metropolis</code>. To calculate the absolute log-likelihood, take the <code>log</code> of <code>normpdf</code></p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/grahamedwards/CorePore.jl/blob/cf002a04f35bb2cee5714eb1a6e1b0ddaef681b3/src/statistics.jl#L13-L20">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="CorePore.normpdf-Tuple{Number, Number, Number}" href="#CorePore.normpdf-Tuple{Number, Number, Number}"><code>CorePore.normpdf</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">normpdf(x, μ, σ)</code></pre><p>Calculate the probability density of a normal distribution with mean <code>μ</code> and standard deviation <code>σ</code> at the value <code>x</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/grahamedwards/CorePore.jl/blob/cf002a04f35bb2cee5714eb1a6e1b0ddaef681b3/src/statistics.jl#L1-L6">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="CorePore.porewaterhistory!-Tuple{SedimentColumn, Proposal, Constants, CorePore.ClimateHistory, Water, Int64}" href="#CorePore.porewaterhistory!-Tuple{SedimentColumn, Proposal, Constants, CorePore.ClimateHistory, Water, Int64}"><code>CorePore.porewaterhistory!</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">porewaterhistory!(sc::SedimentColumn, p::Proposal, k::Constants, climhist::NamedTuple, seawater::Water, ka_dt::Int)</code></pre><p>In-place version of <a href="#CorePore.porewaterhistory-Tuple{Proposal}"><code>porewaterhistory</code></a>, which takes every input as an arg (rather than some defaults as kwargs). It also requires you to provide <code>ka_dt</code> – the number of diffusion timesteps in each thousand-year climate timestep.</p><p>see also: <a href="#CorePore.porewaterhistory-Tuple{Proposal}"><code>porewaterhistory</code></a></p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/grahamedwards/CorePore.jl/blob/cf002a04f35bb2cee5714eb1a6e1b0ddaef681b3/src/history.jl#L1-L11">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="CorePore.porewaterhistory-Tuple{Proposal}" href="#CorePore.porewaterhistory-Tuple{Proposal}"><code>CorePore.porewaterhistory</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">porewaterhistory(p [; k=Constants(), climatehistory=LR04(), seawater=mcmurdosound()])</code></pre><p>Calculate the porewater advection-diffusion history of chlorinity and O-isotope-traced water in a sediment column described by properties in <code>k</code> (::<a href="#CorePore.Constants"><code>Constants</code></a>) over a given <a href="#CorePore.ClimateHistory"><code>ClimateHistory</code></a> (<a href="#CorePore.LR04-Tuple{}"><code>LR04</code></a> by default) and coretop <code>seawater</code> compositions.</p><p><a href="#CorePore.Proposal"><code>Proposal</code></a>) instance <code>p</code> describes the sensitivity and response of the system to climate fluctuations as recorded in <code>climatehistory</code>.</p><p>See <a href="#CorePore.diffuseadvectcolumn!-Tuple{SedimentColumn, Constants, Float64}"><code>diffuseadvectcolumn!</code></a> for the underlying diffusion-advection transport calculations.</p><p>see also: <a href="#CorePore.porewaterhistory!-Tuple{SedimentColumn, Proposal, Constants, CorePore.ClimateHistory, Water, Int64}"><code>porewaterhistory!</code></a>, <a href="#CorePore.Proposal"><code>Proposal</code></a>, <a href="#CorePore.Constants"><code>Constants</code></a>, <a href="#CorePore.LR04-Tuple{}"><code>LR04</code></a>, <a href="#CorePore.Water"><code>Water</code></a></p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/grahamedwards/CorePore.jl/blob/cf002a04f35bb2cee5714eb1a6e1b0ddaef681b3/src/history.jl#L65-L79">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="CorePore.porewatermetropolis-Tuple{Proposal, Proposal, ProposalPriors, CoreData, CorePore.ClimateHistory, Constants}" href="#CorePore.porewatermetropolis-Tuple{Proposal, Proposal, ProposalPriors, CoreData, CorePore.ClimateHistory, Constants}"><code>CorePore.porewatermetropolis</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">porewatermetropolis(p, σ, priors, coredata, cliamte, k; burnin=10, chainsteps=10, climate, k, seawater, onlychloride=true, explore, rng)</code></pre><p>Executes a Markov chain Monte Carlo (MCMC) routine that explores the parameter space of the variables in <a href="#CorePore.Proposal"><code>Proposal</code></a> instance <code>p</code>, constrained by sediment column porewater chemistry records in <a href="#CorePore.CoreData"><code>CoreData</code></a> instance <code>coredata</code> and climate record in <a href="#CorePore.ClimateHistory"><code>ClimateHistory</code></a> instance <code>climate</code> (e.g. <a href="#CorePore.LR04-Tuple{}"><code>LR04</code></a>), and diffusion-advection parameters in <a href="#CorePore.Constants"><code>Constants</code></a> instance <code>k</code> (I recommend using default values <code>Constants()</code>).</p><p><code>Proposal</code> instance <code>σ</code> describes the (1σ) Gaussian jump size corresponding to each field in <code>p</code> (note that fields <code>:dmlt</code>, <code>:dfrz</code>, and <code>:basalCl</code> use a log-normal jump and require a log-space value in <code>σ</code>), and <code>priors</code> are a <a href="#CorePore.ProposalPriors"><code>ProposalPriors</code></a> instance describing the prior bounds on <code>p</code>. </p><p>Kwarg <code>onlychloride</code> determines whether the MCMC inverts for only porewater chloridity (default=<code>true</code>) or porewater chloridity and δ¹⁸O (<code>false</code>).</p><p>Additional kwargs include...</p><table><tr><th style="text-align: left">kwarg</th><th style="text-align: center"><code>DataType</code></th><th style="text-align: left">description</th><th style="text-align: right">default</th></tr><tr><td style="text-align: left">burnin</td><td style="text-align: center"><code>Int</code></td><td style="text-align: left">number of Markov chain burnin-warm-up steps</td><td style="text-align: right"><code>10</code></td></tr><tr><td style="text-align: left">chainsteps</td><td style="text-align: center"><code>Int</code></td><td style="text-align: left">number of recorded Markov chains steps</td><td style="text-align: right"><code>10</code></td></tr><tr><td style="text-align: left">seawater</td><td style="text-align: center"><a href="#CorePore.Water"><code>Water</code></a></td><td style="text-align: left">seawater composition overlying sediment column</td><td style="text-align: right"><code>mcmurdosound()</code></td></tr><tr><td style="text-align: left">explore</td><td style="text-align: center"><code>Tuple{Vararg{Symbol}}</code></td><td style="text-align: left">parameters explored by the MCMC</td><td style="text-align: right"><code>fieldnames(Proposal)</code></td></tr><tr><td style="text-align: left">rng</td><td style="text-align: center"><code>AbstractRNG</code></td><td style="text-align: left">optional random number seed</td><td style="text-align: right"><code>Random.Xoshiro()</code></td></tr></table><p>see also: <a href="#CorePore.Proposal"><code>Proposal</code></a>, <a href="#CorePore.CoreData"><code>CoreData</code></a>, <a href="#CorePore.ClimateHistory"><code>ClimateHistory</code></a>, <a href="#CorePore.Constants"><code>Constants</code></a>, <a href="#CorePore.Water"><code>Water</code></a></p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/grahamedwards/CorePore.jl/blob/cf002a04f35bb2cee5714eb1a6e1b0ddaef681b3/src/metropolis.jl#L89-L113">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="CorePore.proposaljump-Tuple{Proposal, Proposal}" href="#CorePore.proposaljump-Tuple{Proposal, Proposal}"><code>CorePore.proposaljump</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">CorePore.proposaljump(p::Proposal, σ::Proposal; f, rng::AbstractRNG)</code></pre><p>Add a random jump to a randomly selected field of <code>p</code> with a corresponding normal jumping distribution defined by the corresponding field in <code>σ</code>. The possible fields may be specified by providing a Tuple of Symbols <code>f</code> (default=<code>fieldnames(Proposal)</code>), and a specific RNG seed may be provided.</p><p>Note that <code>:dmlt</code>, <code>:dfrz</code>, and <code>:basalCl</code> are drawn from a lognormal jumping distribution (where <code>σ</code> is in log-space.)</p><p>see also: <a href="#CorePore.porewatermetropolis-Tuple{Proposal, Proposal, ProposalPriors, CoreData, CorePore.ClimateHistory, Constants}"><code>porewatermetropolis</code></a>, <a href="#CorePore.Proposal"><code>Proposal</code></a></p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/grahamedwards/CorePore.jl/blob/cf002a04f35bb2cee5714eb1a6e1b0ddaef681b3/src/metropolis.jl#L64-L74">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="CorePore.stopwatch-Tuple{Integer, Integer, Number}" href="#CorePore.stopwatch-Tuple{Integer, Integer, Number}"><code>CorePore.stopwatch</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">stopwatch(i, n, t)</code></pre><p>Convenience function for [<code>porewatermetropolis</code>] that returns a String reporting the progress at step <code>i</code> for total steps <code>n</code> with start time <code>t</code> (in s since the epoch).</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/grahamedwards/CorePore.jl/blob/cf002a04f35bb2cee5714eb1a6e1b0ddaef681b3/src/metropolis.jl#L1-L7">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="CorePore.strictpriors-Tuple{Proposal, Number, Tuple{Number, Number}, Number}" href="#CorePore.strictpriors-Tuple{Proposal, Number, Tuple{Number, Number}, Number}"><code>CorePore.strictpriors</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>!!! DEPRECATED !!!     CorePore.strictpriors(p::Proposal, record<em>max</em>age::Number, climatelimits::Tuple{Number,Number}, depth::Number)</p><p>Evalute strict constraints on priors that will automatically reject a proposal with..</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/grahamedwards/CorePore.jl/blob/cf002a04f35bb2cee5714eb1a6e1b0ddaef681b3/src/metropolis.jl#L15-L22">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="CorePore.update-Tuple{Proposal, Symbol, Number}" href="#CorePore.update-Tuple{Proposal, Symbol, Number}"><code>CorePore.update</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">update(p::Proposal, f::Symbol, x::Number)</code></pre><p>Update field <code>f</code> of <a href="#CorePore.Proposal"><code>Proposal</code></a> instance <code>p</code> with value <code>x</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/grahamedwards/CorePore.jl/blob/cf002a04f35bb2cee5714eb1a6e1b0ddaef681b3/src/parameters.jl#L367-L372">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="CorePore.velocity-Tuple{Any, Any, Any}" href="#CorePore.velocity-Tuple{Any, Any, Any}"><code>CorePore.velocity</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">velocity(x, above, k)</code></pre><p>Calculate the velocity (m/yr) at a node with density <code>x</code>, given the density of the node <code>above</code>, and the hydraulic conductivity <code>k</code> (m/yr).</p><p>see also: <a href="#CorePore.density-Tuple{Any}"><code>density</code></a></p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/grahamedwards/CorePore.jl/blob/cf002a04f35bb2cee5714eb1a6e1b0ddaef681b3/src/diffuse.jl#L79-L87">source</a></section></article></article><nav class="docs-footer"><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.7.0 on <span class="colophon-date" title="Wednesday 4 September 2024 15:03">Wednesday 4 September 2024</span>. Using Julia version 1.10.5.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
